<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AutoJobApply - Automated Job Application Tool</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.0.0/css/all.min.css">
    <style>
        .tab-content {
            display: none;
        }
        .tab-content.active {
            display: block;
        }
        .loader {
            border-top-color: #3498db;
            -webkit-animation: spinner 1.5s linear infinite;
            animation: spinner 1.5s linear infinite;
        }
        @-webkit-keyframes spinner {
            0% { -webkit-transform: rotate(0deg); }
            100% { -webkit-transform: rotate(360deg); }
        }
        @keyframes spinner {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <header class="mb-8">
            <div class="flex justify-between items-center">
                <div class="flex items-center">
                    <i class="fas fa-briefcase text-3xl text-blue-600 mr-3"></i>
                    <h1 class="text-2xl font-bold text-gray-800">AutoJobApply</h1>
                </div>
                <div id="status-indicator" class="hidden px-4 py-2 rounded-full text-sm font-medium">
                    <span id="status-text">Idle</span>
                </div>
            </div>
            <p class="mt-2 text-gray-600">Automate your job application process across multiple platforms</p>
        </header>

        <!-- Alert Banner -->
        <div class="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 mb-6" role="alert">
            <div class="flex items-start">
                <div class="flex-shrink-0">
                    <i class="fas fa-exclamation-triangle mt-1"></i>
                </div>
                <div class="ml-3">
                    <p class="font-bold">Disclaimer</p>
                    <p class="text-sm">This tool is for educational purposes only. Using automation to apply for jobs may violate the terms of service of job platforms. Always use responsibly and in compliance with each platform's policies. This tool does not store your data on any server; all information remains in your browser's local storage.</p>
                </div>
            </div>
        </div>

        <!-- Main Tabs -->
        <div class="bg-white rounded-lg shadow-md mb-6">
            <div class="border-b border-gray-200">
                <nav class="flex -mb-px">
                    <button class="tab-button text-blue-600 border-blue-600 whitespace-nowrap py-4 px-6 border-b-2 font-medium text-sm" data-tab="setup">
                        <i class="fas fa-user-cog mr-2"></i>Profile Setup
                    </button>
                    <button class="tab-button text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-6 border-b-2 border-transparent font-medium text-sm" data-tab="platforms">
                        <i class="fas fa-globe mr-2"></i>Job Platforms
                    </button>
                    <button class="tab-button text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-6 border-b-2 border-transparent font-medium text-sm" data-tab="automation">
                        <i class="fas fa-robot mr-2"></i>Automation
                    </button>
                    <button class="tab-button text-gray-500 hover:text-gray-700 hover:border-gray-300 whitespace-nowrap py-4 px-6 border-b-2 border-transparent font-medium text-sm" data-tab="history">
                        <i class="fas fa-history mr-2"></i>Application History
                    </button>
                </nav>
            </div>

            <!-- Tab Contents -->
            <div class="p-6">
                <!-- Profile Setup Tab -->
                <div id="setup" class="tab-content active">
                    <h2 class="text-xl font-semibold mb-4">Personal Information & Resume</h2>
                    <p class="mb-4 text-gray-600">Set up your profile information that will be used across job applications.</p>
                    
                    <form id="profile-form" class="space-y-6">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Full Name</label>
                                <input type="text" id="fullName" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500" placeholder="John Doe">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                                <input type="email" id="email" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500" placeholder="john.doe@example.com">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Phone Number</label>
                                <input type="tel" id="phone" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500" placeholder="+1 (123) 456-7890">
                            </div>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-1">Location</label>
                                <input type="text" id="location" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500" placeholder="New York, NY">
                            </div>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Professional Title</label>
                            <input type="text" id="title" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500" placeholder="Senior Software Engineer">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Resume (Upload or Paste)</label>
                            <div class="flex space-x-4 mb-2">
                                <button type="button" id="upload-resume-btn" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400">
                                    <i class="fas fa-upload mr-2"></i>Upload Resume
                                </button>
                                <input type="file" id="resume-file" class="hidden" accept=".pdf,.doc,.docx">
                                <span id="file-name" class="text-sm text-gray-500 self-center"></span>
                            </div>
                            <textarea id="resume-text" rows="6" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500" placeholder="Paste your resume text here for platforms that require plain text..."></textarea>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Cover Letter Template</label>
                            <textarea id="cover-letter" rows="6" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500" placeholder="Add your cover letter template here. Use {{COMPANY}} as a placeholder for the company name and {{POSITION}} for the job title."></textarea>
                        </div>

                        <div class="flex justify-end">
                            <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <i class="fas fa-save mr-2"></i>Save Profile
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Job Platforms Tab -->
                <div id="platforms" class="tab-content">
                    <h2 class="text-xl font-semibold mb-4">Job Platforms Configuration</h2>
                    <p class="mb-4 text-gray-600">Add job platforms and customize how the automation works for each of them.</p>

                    <div class="space-y-6">
                        <!-- Platform List -->
                        <div id="platforms-list" class="space-y-4">
                            <!-- Platform items will be added here dynamically -->
                            <div class="text-gray-500 text-center py-6" id="no-platforms-msg">
                                <i class="fas fa-info-circle text-xl mb-2"></i>
                                <p>No platforms added yet. Add your first job platform below.</p>
                            </div>
                        </div>

                        <!-- Add New Platform Form -->
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <h3 class="text-lg font-medium mb-3">Add New Platform</h3>
                            <form id="platform-form" class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Platform Name</label>
                                    <div class="flex">
                                        <select id="platform-type" class="w-1/3 px-3 py-2 border border-gray-300 rounded-l-md focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                            <option value="linkedin">LinkedIn</option>
                                            <option value="indeed">Indeed</option>
                                            <option value="glassdoor">Glassdoor</option>
                                            <option value="ziprecruiter">ZipRecruiter</option>
                                            <option value="monster">Monster</option>
                                            <option value="custom">Custom</option>
                                        </select>
                                        <input type="text" id="custom-platform-name" class="w-2/3 px-3 py-2 border border-gray-300 rounded-r-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 hidden" placeholder="Enter custom platform name">
                                    </div>
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Base URL or Job Search URL</label>
                                    <input type="url" id="platform-url" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500" placeholder="https://www.linkedin.com/jobs/search/?keywords=software%20engineer">
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Search Keywords</label>
                                    <input type="text" id="keywords" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500" placeholder="software engineer, developer, javascript">
                                    <p class="mt-1 text-sm text-gray-500">Separate multiple keywords with commas</p>
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Location</label>
                                    <input type="text" id="job-location" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500" placeholder="New York, Remote">
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Application Filters</label>
                                    
                                    <div class="space-y-2">
                                        <div class="flex items-center">
                                            <input type="checkbox" id="filter-easy-apply" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                            <label for="filter-easy-apply" class="ml-2 text-sm text-gray-700">Easy Apply Only</label>
                                        </div>
                                        
                                        <div class="flex items-center">
                                            <input type="checkbox" id="filter-no-assessment" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                            <label for="filter-no-assessment" class="ml-2 text-sm text-gray-700">Skip Jobs with Assessments</label>
                                        </div>
                                        
                                        <div class="flex items-center">
                                            <input type="checkbox" id="filter-recent-only" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                            <label for="filter-recent-only" class="ml-2 text-sm text-gray-700">Recent Jobs Only (posted < 7 days)</label>
                                        </div>
                                    </div>
                                </div>

                                <div class="flex justify-end">
                                    <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                        <i class="fas fa-plus mr-2"></i>Add Platform
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>

                <!-- Automation Tab -->
                <div id="automation" class="tab-content">
                    <h2 class="text-xl font-semibold mb-4">Automation Control Panel</h2>
                    <p class="mb-4 text-gray-600">Configure and start the automated job application process.</p>

                    <div class="space-y-6">
                        <div class="bg-gray-50 p-4 rounded-lg">
                            <h3 class="text-lg font-medium mb-3">Automation Settings</h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Daily Application Limit</label>
                                    <input type="number" id="daily-limit" min="1" max="100" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500" value="20">
                                    <p class="mt-1 text-sm text-gray-500">Maximum number of applications to submit per day</p>
                                </div>

                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-1">Time Between Applications (seconds)</label>
                                    <input type="number" id="time-between" min="30" max="600" class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500" value="120">
                                    <p class="mt-1 text-sm text-gray-500">Delay between job applications to avoid triggering spam detection</p>
                                </div>

                                <div class="space-y-2">
                                    <div class="flex items-center">
                                        <input type="checkbox" id="auto-follow" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                        <label for="auto-follow" class="ml-2 text-sm text-gray-700">Automatically follow companies after applying</label>
                                    </div>
                                    
                                    <div class="flex items-center">
                                        <input type="checkbox" id="save-jobs" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                        <label for="save-jobs" class="ml-2 text-sm text-gray-700">Save jobs to platform's saved jobs list</label>
                                    </div>
                                    
                                    <div class="flex items-center">
                                        <input type="checkbox" id="randomize-delay" class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded" checked>
                                        <label for="randomize-delay" class="ml-2 text-sm text-gray-700">Randomize delay between applications (recommended)</label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="bg-white p-4 border border-gray-200 rounded-lg">
                            <h3 class="text-lg font-medium mb-3">Platform Selection</h3>
                            <div id="platform-selection" class="space-y-2">
                                <div class="text-gray-500 text-center py-4" id="no-platforms-automation">
                                    <p>No platforms configured. Please add job platforms in the "Job Platforms" tab.</p>
                                </div>
                                <!-- Platform checkboxes will be added here dynamically -->
                            </div>
                        </div>

                        <div class="bg-gray-100 p-6 rounded-lg">
                            <h3 class="text-lg font-medium mb-3">Automation Control</h3>
                            <div class="space-y-4">
                                <div id="automation-status" class="p-4 bg-blue-50 text-blue-700 rounded-md">
                                    <p><i class="fas fa-info-circle mr-2"></i>The automation will open a new browser window and run the job application process. Keep the window open while the automation is running.</p>
                                </div>
                                
                                <div class="hidden" id="simulation-container">
                                    <div class="mb-2 font-medium">Simulation Preview:</div>
                                    <div class="border border-gray-300 rounded-md p-4 bg-white h-64 overflow-y-auto" id="simulation-output">
                                        <!-- Simulation output will be displayed here -->
                                    </div>
                                </div>

                                <div class="flex flex-wrap gap-4">
                                    <button id="start-automation" class="px-6 py-3 bg-green-600 text-white rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 disabled:opacity-50 disabled:cursor-not-allowed">
                                        <i class="fas fa-play mr-2"></i>Start Automation
                                    </button>
                                    <button id="stop-automation" class="px-6 py-3 bg-red-600 text-white rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 hidden">
                                        <i class="fas fa-stop mr-2"></i>Stop Automation
                                    </button>
                                    <button id="simulate-automation" class="px-6 py-3 bg-blue-500 text-white rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-400">
                                        <i class="fas fa-vial mr-2"></i>Run Simulation
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Application History Tab -->
                <div id="history" class="tab-content">
                    <h2 class="text-xl font-semibold mb-4">Application History</h2>
                    <p class="mb-4 text-gray-600">Track all your automated job applications.</p>

                    <div class="space-y-6">
                        <div class="flex justify-between mb-4">
                            <div class="flex space-x-2">
                                <select id="history-filter" class="px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                                    <option value="all">All Applications</option>
                                    <option value="today">Today</option>
                                    <option value="week">This Week</option>
                                    <option value="month">This Month</option>
                                </select>
                                <button id="refresh-history" class="px-3 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400">
                                    <i class="fas fa-sync-alt"></i>
                                </button>
                            </div>
                            <div>
                                <button id="export-history" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                                    <i class="fas fa-file-export mr-2"></i>Export CSV
                                </button>
                            </div>
                        </div>

                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Job Title</th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Company</th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Platform</th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Date Applied</th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                        <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="applications-table" class="bg-white divide-y divide-gray-200">
                                    <!-- Application entries will be added here dynamically -->
                                    <tr id="no-applications" class="text-center">
                                        <td colspan="6" class="px-6 py-10 text-gray-500">
                                            <i class="fas fa-inbox text-3xl mb-3"></i>
                                            <p>No applications have been submitted yet.</p>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>

                        <div class="bg-white p-4 rounded-lg shadow-sm">
                            <h3 class="text-lg font-medium mb-3">Application Statistics</h3>
                            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                                <div class="bg-blue-50 p-4 rounded-md">
                                    <p class="text-sm text-blue-700">Total Applications</p>
                                    <p id="stat-total" class="text-2xl font-bold">0</p>
                                </div>
                                <div class="bg-green-50 p-4 rounded-md">
                                    <p class="text-sm text-green-700">This Week</p>
                                    <p id="stat-week" class="text-2xl font-bold">0</p>
                                </div>
                                <div class="bg-purple-50 p-4 rounded-md">
                                    <p class="text-sm text-purple-700">Most Applied Platform</p>
                                    <p id="stat-platform" class="text-2xl font-bold">-</p>
                                </div>
                                <div class="bg-yellow-50 p-4 rounded-md">
                                    <p class="text-sm text-yellow-700">Average Per Day</p>
                                    <p id="stat-avg" class="text-2xl font-bold">0</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer class="text-center text-gray-500 text-sm mt-8">
            <p>AutoJobApply - An Automated Job Application Tool</p>
            <p class="mt-1">This is a client-side application. Your data never leaves your browser.</p>
        </footer>
    </div>

    <!-- JavaScript -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Tab Navigation
            const tabButtons = document.querySelectorAll('.tab-button');
            const tabContents = document.querySelectorAll('.tab-content');

            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const tabName = button.getAttribute('data-tab');
                    
                    // Hide all tabs and remove active class from buttons
                    tabContents.forEach(tab => tab.classList.remove('active'));
                    tabButtons.forEach(btn => {
                        btn.classList.remove('text-blue-600', 'border-blue-600');
                        btn.classList.add('text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300', 'border-transparent');
                    });
                    
                    // Show selected tab and add active class to clicked button
                    document.getElementById(tabName).classList.add('active');
                    button.classList.remove('text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300', 'border-transparent');
                    button.classList.add('text-blue-600', 'border-blue-600');
                    
                    // Update UI based on selected tab
                    if (tabName === 'platforms') {
                        loadPlatforms();
                    } else if (tabName === 'automation') {
                        loadPlatformsForAutomation();
                    } else if (tabName === 'history') {
                        loadApplicationHistory();
                        updateStatistics();
                    }
                });
            });

            // Initialize data objects
            const data = {
                profile: {},
                platforms: [],
                applications: []
            };

            // Load data from localStorage
            function loadDataFromStorage() {
                const profileData = localStorage.getItem('autojobapply-profile');
                const platformsData = localStorage.getItem('autojobapply-platforms');
                const applicationsData = localStorage.getItem('autojobapply-applications');

                if (profileData) {
                    data.profile = JSON.parse(profileData);
                    populateProfileForm(data.profile);
                }

                if (platformsData) {
                    data.platforms = JSON.parse(platformsData);
                }

                if (applicationsData) {
                    data.applications = JSON.parse(applicationsData);
                }
            }

            // Save data to localStorage
            function saveDataToStorage() {
                localStorage.setItem('autojobapply-profile', JSON.stringify(data.profile));
                localStorage.setItem('autojobapply-platforms', JSON.stringify(data.platforms));
                localStorage.setItem('autojobapply-applications', JSON.stringify(data.applications));
            }

            // Populate profile form with existing data
            function populateProfileForm(profile) {
                document.getElementById('fullName').value = profile.fullName || '';
                document.getElementById('email').value = profile.email || '';
                document.getElementById('phone').value = profile.phone || '';
                document.getElementById('location').value = profile.location || '';
                document.getElementById('title').value = profile.title || '';
                document.getElementById('resume-text').value = profile.resumeText || '';
                document.getElementById('cover-letter').value = profile.coverLetter || '';
                
                if (profile.fileName) {
                    document.getElementById('file-name').textContent = profile.fileName;
                }
            }

            // Profile Form Submission
            document.getElementById('profile-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                data.profile = {
                    fullName: document.getElementById('fullName').value,
                    email: document.getElementById('email').value,
                    phone: document.getElementById('phone').value,
                    location: document.getElementById('location').value,
                    title: document.getElementById('title').value,
                    resumeText: document.getElementById('resume-text').value,
                    coverLetter: document.getElementById('cover-letter').value,
                    fileName: document.getElementById('file-name').textContent || ''
                };
                
                saveDataToStorage();
                
                // Show success message
                alert('Profile saved successfully!');
            });

            // Resume File Upload
            document.getElementById('upload-resume-btn').addEventListener('click', function() {
                document.getElementById('resume-file').click();
            });

            document.getElementById('resume-file').addEventListener('change', function(e) {
                if (e.target.files.length > 0) {
                    const file = e.target.files[0];
                    document.getElementById('file-name').textContent = file.name;
                    
                    // For demo purposes we're just storing the filename
                    // In a real app, you might want to store the file itself
                    data.profile.fileName = file.name;
                    
                    // You could also read text files:
                    if (file.type === 'text/plain') {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            document.getElementById('resume-text').value = e.target.result;
                        };
                        reader.readAsText(file);
                    }
                }
            });

            // Platform Type Selection
            document.getElementById('platform-type').addEventListener('change', function() {
                const customNameField = document.getElementById('custom-platform-name');
                if (this.value === 'custom') {
                    customNameField.classList.remove('hidden');
                    customNameField.required = true;
                } else {
                    customNameField.classList.add('hidden');
                    customNameField.required = false;
                }
            });

            // Platform Form Submission
            document.getElementById('platform-form').addEventListener('submit', function(e) {
                e.preventDefault();
                
                const platformType = document.getElementById('platform-type').value;
                let platformName = platformType;
                
                if (platformType === 'custom') {
                    platformName = document.getElementById('custom-platform-name').value;
                }
                
                const newPlatform = {
                    id: Date.now().toString(),
                    name: platformName,
                    type: platformType,
                    url: document.getElementById('platform-url').value,
                    keywords: document.getElementById('keywords').value,
                    location: document.getElementById('job-location').value,
                    filters: {
                        easyApplyOnly: document.getElementById('filter-easy-apply').checked,
                        skipAssessments: document.getElementById('filter-no-assessment').checked,
                        recentOnly: document.getElementById('filter-recent-only').checked
                    }
                };
                
                data.platforms.push(newPlatform);
                saveDataToStorage();
                
                // Reset form
                this.reset();
                document.getElementById('custom-platform-name').classList.add('hidden');
                
                // Update UI
                loadPlatforms();
                
                // Show success message
                alert('Platform added successfully!');
            });

            // Load platforms to the platforms tab
            function loadPlatforms() {
                const platformsList = document.getElementById('platforms-list');
                const noPlatformsMsg = document.getElementById('no-platforms-msg');
                
                // Clear existing platforms
                while (platformsList.firstChild && platformsList.firstChild !== noPlatformsMsg) {
                    platformsList.removeChild(platformsList.firstChild);
                }
                
                if (data.platforms.length === 0) {
                    noPlatformsMsg.classList.remove('hidden');
                    return;
                }
                
                noPlatformsMsg.classList.add('hidden');
                
                // Add platforms to the list
                data.platforms.forEach(platform => {
                    const platformItem = document.createElement('div');
                    platformItem.className = 'bg-white p-4 rounded-lg shadow-sm border border-gray-200';
                    platformItem.innerHTML = `
                        <div class="flex justify-between items-start">
                            <div>
                                <h4 class="text-lg font-medium">${platform.name}</h4>
                                <p class="text-sm text-gray-600 mt-1">${platform.url}</p>
                                <div class="mt-2">
                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 mr-2">
                                        Keywords: ${platform.keywords}
                                    </span>
                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800">
                                        Location: ${platform.location || 'Any'}
                                    </span>
                                </div>
                                <div class="mt-2">
                                    ${platform.filters.easyApplyOnly ? '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 mr-2">Easy Apply Only</span>' : ''}
                                    ${platform.filters.skipAssessments ? '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 mr-2">Skip Assessments</span>' : ''}
                                    ${platform.filters.recentOnly ? '<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800">Recent Only</span>' : ''}
                                </div>
                            </div>
                            <div class="flex space-x-2">
                                <button class="edit-platform text-gray-500 hover:text-blue-600" data-id="${platform.id}">
                                    <i class="fas fa-edit"></i>
                                </button>
                                <button class="delete-platform text-gray-500 hover:text-red-600" data-id="${platform.id}">
                                    <i class="fas fa-trash-alt"></i>
                                </button>
                            </div>
                        </div>
                    `;
                    
                    // Insert at the top of the list
                    if (platformsList.firstChild && platformsList.firstChild !== noPlatformsMsg) {
                        platformsList.insertBefore(platformItem, platformsList.firstChild);
                    } else {
                        platformsList.appendChild(platformItem);
                    }
                });
                
                // Add event listeners for edit and delete buttons
                document.querySelectorAll('.edit-platform').forEach(button => {
                    button.addEventListener('click', function() {
                        alert('Edit functionality would be implemented here in a real application.');
                    });
                });
                
                document.querySelectorAll('.delete-platform').forEach(button => {
                    button.addEventListener('click', function() {
                        const platformId = this.getAttribute('data-id');
                        if (confirm('Are you sure you want to delete this platform?')) {
                            data.platforms = data.platforms.filter(p => p.id !== platformId);
                            saveDataToStorage();
                            loadPlatforms();
                            loadPlatformsForAutomation();
                        }
                    });
                });
            }

            // Load platforms to the automation tab
            function loadPlatformsForAutomation() {
                const platformSelection = document.getElementById('platform-selection');
                const noPlatformsMsg = document.getElementById('no-platforms-automation');
                
                // Clear existing checkboxes
                while (platformSelection.firstChild && platformSelection.firstChild !== noPlatformsMsg) {
                    platformSelection.removeChild(platformSelection.firstChild);
                }
                
                if (data.platforms.length === 0) {
                    noPlatformsMsg.classList.remove('hidden');
                    document.getElementById('start-automation').disabled = true;
                    document.getElementById('simulate-automation').disabled = true;
                    return;
                }
                
                noPlatformsMsg.classList.add('hidden');
                document.getElementById('start-automation').disabled = false;
                document.getElementById('simulate-automation').disabled = false;
                
                // Add platform checkboxes
                data.platforms.forEach(platform => {
                    const checkbox = document.createElement('div');
                    checkbox.className = 'flex items-center';
                    checkbox.innerHTML = `
                        <input type="checkbox" id="platform-${platform.id}" class="platform-checkbox h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded" value="${platform.id}">
                        <label for="platform-${platform.id}" class="ml-2 text-sm text-gray-700">${platform.name} - ${platform.url}</label>
                    `;
                    platformSelection.appendChild(checkbox);
                });
            }

            // Automation Control: Start Button
            document.getElementById('start-automation').addEventListener('click', function() {
                const selectedPlatforms = Array.from(document.querySelectorAll('.platform-checkbox:checked')).map(checkbox => checkbox.value);
                
                if (selectedPlatforms.length === 0) {
                    alert('Please select at least one platform to automate.');
                    return;
                }
                
                if (!data.profile.fullName || !data.profile.email) {
                    alert('Please complete your profile information in the Profile Setup tab before starting automation.');
                    return;
                }
                
                // Show confirmation dialog
                if (confirm('The automation will now start in a new browser window. Please ensure you remain logged into the job platforms. Continue?')) {
                    // In a real application, this would launch the actual automation
                    // For this demo, we'll just show a status change
                    document.getElementById('start-automation').classList.add('hidden');
                    document.getElementById('stop-automation').classList.remove('hidden');
                    
                    const statusIndicator = document.getElementById('status-indicator');
                    statusIndicator.classList.remove('hidden');
                    statusIndicator.classList.add('bg-green-100', 'text-green-800');
                    document.getElementById('status-text').textContent = 'Automation Running';
                    
                    alert('In a real application, the automation would now begin in a new window. This is a simulation.');
                    
                    // For demo purposes, simulate some job applications
                    simulateApplications(selectedPlatforms);
                }
            });

            // Automation Control: Stop Button
            document.getElementById('stop-automation').addEventListener('click', function() {
                if (confirm('Are you sure you want to stop the automation?')) {
                    document.getElementById('stop-automation').classList.add('hidden');
                    document.getElementById('start-automation').classList.remove('hidden');
                    
                    const statusIndicator = document.getElementById('status-indicator');
                    statusIndicator.classList.remove('bg-green-100', 'text-green-800');
                    statusIndicator.classList.add('bg-gray-100', 'text-gray-800');
                    document.getElementById('status-text').textContent = 'Automation Stopped';
                    
                    // After a delay, hide the status indicator
                    setTimeout(() => {
                        statusIndicator.classList.add('hidden');
                    }, 5000);
                }
            });

            // Simulation Button
            document.getElementById('simulate-automation').addEventListener('click', function() {
                const selectedPlatforms = Array.from(document.querySelectorAll('.platform-checkbox:checked')).map(checkbox => checkbox.value);
                
                if (selectedPlatforms.length === 0) {
                    alert('Please select at least one platform to simulate.');
                    return;
                }
                
                // Show simulation container
                document.getElementById('simulation-container').classList.remove('hidden');
                const simulationOutput = document.getElementById('simulation-output');
                simulationOutput.innerHTML = '<p class="text-gray-600">Starting simulation...</p>';
                
                // Simulate the process
                simulateBrowserAutomation(selectedPlatforms, simulationOutput);
            });

            // Simulate job applications (for demonstration purposes)
            function simulateApplications(platformIds) {
                const companies = ['TechCorp', 'DataSystems', 'WebFlow', 'CloudNine', 'CodeMasters', 'InnovateIT', 'DevSolutions'];
                const titles = ['Software Engineer', 'Full Stack Developer', 'Frontend Developer', 'Backend Engineer', 'DevOps Specialist'];
                const statuses = ['Applied', 'Application Viewed', 'Under Review'];
                
                const selectedPlatforms = data.platforms.filter(p => platformIds.includes(p.id));
                
                // Generate 3-7 random applications
                const count = Math.floor(Math.random() * 5) + 3;
                
                for (let i = 0; i < count; i++) {
                    const platform = selectedPlatforms[Math.floor(Math.random() * selectedPlatforms.length)];
                    const company = companies[Math.floor(Math.random() * companies.length)];
                    const title = titles[Math.floor(Math.random() * titles.length)];
                    const status = statuses[Math.floor(Math.random() * statuses.length)];
                    
                    const newApplication = {
                        id: Date.now() + i,
                        jobTitle: title,
                        company: company,
                        platform: platform.name,
                        dateApplied: new Date().toISOString(),
                        status: status,
                        url: platform.url
                    };
                    
                    data.applications.push(newApplication);
                }
                
                saveDataToStorage();
                
                // If the history tab is currently visible, update it
                if (document.getElementById('history').classList.contains('active')) {
                    loadApplicationHistory();
                    updateStatistics();
                }
            }

            // Simulate browser automation process (for demonstration purposes)
            function simulateBrowserAutomation(platformIds, outputElement) {
                const selectedPlatforms = data.platforms.filter(p => platformIds.includes(p.id));
                const steps = [];
                
                // Generate automation steps
                selectedPlatforms.forEach(platform => {
                    steps.push(`Initializing automated browser for ${platform.name}...`);
                    steps.push(`Navigating to ${platform.url}...`);
                    steps.push(`Searching for jobs matching "${platform.keywords}" in "${platform.location || 'Any location'}"...`);
                    steps.push(`Found 27 potential job listings...`);
                    steps.push(`Filtering job listings based on criteria...`);
                    steps.push(`Found 12 jobs that match all criteria...`);
                    steps.push(`Starting application process for the first job...`);
                    steps.push(`Filling out application form with profile data...`);
                    steps.push(`Uploading resume...`);
                    steps.push(`Submitting application...`);
                    steps.push(`Application submitted successfully! Moving to next job...`);
                    // Add more steps for additional jobs
                });
                
                // Simulate execution with delays
                let currentStep = 0;
                outputElement.innerHTML = '';
                
                function addStep() {
                    if (currentStep < steps.length) {
                        const p = document.createElement('p');
                        p.className = 'mb-2';
                        p.innerHTML = `<span class="text-gray-500">[${new Date().toLocaleTimeString()}]</span> ${steps[currentStep]}`;
                        outputElement.appendChild(p);
                        outputElement.scrollTop = outputElement.scrollHeight;
                        currentStep++;
                        
                        // Random delay between 500ms and 1500ms
                        const delay = Math.floor(Math.random() * 1000) + 500;
                        setTimeout(addStep, delay);
                    } else {
                        // Simulation complete
                        const p = document.createElement('p');
                        p.className = 'mt-4 font-medium text-green-600';
                        p.innerHTML = 'Simulation completed successfully! In a real implementation, the application would have applied to multiple jobs.';
                        outputElement.appendChild(p);
                        
                        // Add some sample applications to history
                        simulateApplications(platformIds);
                    }
                }
                
                addStep();
            }

            // Load application history to the history tab
            function loadApplicationHistory() {
                const applicationsTable = document.getElementById('applications-table');
                const noApplicationsRow = document.getElementById('no-applications');
                
                // Remove existing rows except for the "no applications" row
                while (applicationsTable.firstChild && applicationsTable.firstChild !== noApplicationsRow) {
                    applicationsTable.removeChild(applicationsTable.firstChild);
                }
                
                if (data.applications.length === 0) {
                    noApplicationsRow.classList.remove('hidden');
                    return;
                }
                
                noApplicationsRow.classList.add('hidden');
                
                // Filter applications based on selected filter
                const filter = document.getElementById('history-filter').value;
                let filteredApplications = [...data.applications];
                
                const now = new Date();
                if (filter === 'today') {
                    const today = new Date(now.getFullYear(), now.getMonth(), now.getDate()).getTime();
                    filteredApplications = filteredApplications.filter(app => {
                        const appDate = new Date(app.dateApplied).getTime();
                        return appDate >= today;
                    });
                } else if (filter === 'week') {
                    const weekStart = new Date(now);
                    weekStart.setDate(now.getDate() - now.getDay());
                    weekStart.setHours(0, 0, 0, 0);
                    filteredApplications = filteredApplications.filter(app => {
                        const appDate = new Date(app.dateApplied).getTime();
                        return appDate >= weekStart.getTime();
                    });
                } else if (filter === 'month') {
                    const monthStart = new Date(now.getFullYear(), now.getMonth(), 1).getTime();
                    filteredApplications = filteredApplications.filter(app => {
                        const appDate = new Date(app.dateApplied).getTime();
                        return appDate >= monthStart;
                    });
                }
                
                // Sort applications by date (newest first)
                filteredApplications.sort((a, b) => {
                    return new Date(b.dateApplied) - new Date(a.dateApplied);
                });
                
                // Add applications to the table
                filteredApplications.forEach(app => {
                    const row = document.createElement('tr');
                    
                    const formatDate = (dateString) => {
                        const date = new Date(dateString);
                        return date.toLocaleDateString() + ' ' + date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                    };
                    
                    let statusClass = 'bg-blue-100 text-blue-800';
                    if (app.status.toLowerCase().includes('viewed')) {
                        statusClass = 'bg-yellow-100 text-yellow-800';
                    } else if (app.status.toLowerCase().includes('review')) {
                        statusClass = 'bg-green-100 text-green-800';
                    }
                    
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${app.jobTitle}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${app.company}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${app.platform}</td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">${formatDate(app.dateApplied)}</td>
                        <td class="px-6 py-4 whitespace-nowrap">
                            <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${statusClass}">
                                ${app.status}
                            </span>
                        </td>
                        <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">
                            <button class="text-blue-600 hover:text-blue-900 view-application" data-id="${app.id}">
                                <i class="fas fa-eye mr-1"></i>View
                            </button>
                        </td>
                    `;
                    
                    applicationsTable.appendChild(row);
                });
                
                // Add event listeners for view buttons
                document.querySelectorAll('.view-application').forEach(button => {
                    button.addEventListener('click', function() {
                        const appId = parseInt(this.getAttribute('data-id'));
                        const application = data.applications.find(app => app.id === appId);
                        
                        if (application) {
                            alert(`Application Details:\n\nJob: ${application.jobTitle}\nCompany: ${application.company}\nPlatform: ${application.platform}\nDate: ${new Date(application.dateApplied).toLocaleString()}\nStatus: ${application.status}\n\nIn a full implementation, this would show more details and allow tracking of the application status.`);
                        }
                    });
                });
            }

            // Update application statistics
            function updateStatistics() {
                const totalApps = data.applications.length;
                document.getElementById('stat-total').textContent = totalApps;
                
                // Calculate applications this week
                const now = new Date();
                const weekStart = new Date(now);
                weekStart.setDate(now.getDate() - now.getDay());
                weekStart.setHours(0, 0, 0, 0);
                
                const weekApps = data.applications.filter(app => {
                    const appDate = new Date(app.dateApplied).getTime();
                    return appDate >= weekStart.getTime();
                }).length;
                
                document.getElementById('stat-week').textContent = weekApps;
                
                // Calculate most used platform
                if (totalApps > 0) {
                    const platformCounts = {};
                    data.applications.forEach(app => {
                        platformCounts[app.platform] = (platformCounts[app.platform] || 0) + 1;
                    });
                    
                    let mostUsedPlatform = '';
                    let maxCount = 0;
                    
                    for (const platform in platformCounts) {
                        if (platformCounts[platform] > maxCount) {
                            mostUsedPlatform = platform;
                            maxCount = platformCounts[platform];
                        }
                    }
                    
                    document.getElementById('stat-platform').textContent = mostUsedPlatform;
                } else {
                    document.getElementById('stat-platform').textContent = '-';
                }
                
                // Calculate average per day
                if (totalApps > 0) {
                    const dates = {};
                    data.applications.forEach(app => {
                        const date = new Date(app.dateApplied).toLocaleDateString();
                        dates[date] = (dates[date] || 0) + 1;
                    });
                    
                    const totalDays = Object.keys(dates).length;
                    const avgPerDay = (totalApps / totalDays).toFixed(1);
                    
                    document.getElementById('stat-avg').textContent = avgPerDay;
                } else {
                    document.getElementById('stat-avg').textContent = '0';
                }
            }

            // Filter applications by date range
            document.getElementById('history-filter').addEventListener('change', function() {
                loadApplicationHistory();
            });

            // Refresh application history
            document.getElementById('refresh-history').addEventListener('click', function() {
                loadApplicationHistory();
                updateStatistics();
            });

            // Export applications as CSV
            document.getElementById('export-history').addEventListener('click', function() {
                if (data.applications.length === 0) {
                    alert('No applications to export.');
                    return;
                }
                
                // Create CSV content
                let csv = 'Job Title,Company,Platform,Date Applied,Status\n';
                
                data.applications.forEach(app => {
                    const formatDate = (dateString) => {
                        const date = new Date(dateString);
                        return date.toLocaleDateString() + ' ' + date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
                    };
                    
                    csv += `"${app.jobTitle}","${app.company}","${app.platform}","${formatDate(app.dateApplied)}","${app.status}"\n`;
                });
                
                // Create download link
                const blob = new Blob([csv], { type: 'text/csv' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.setAttribute('hidden', '');
                a.setAttribute('href', url);
                a.setAttribute('download', 'job_applications.csv');
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            });

            // Load data when the page loads
            loadDataFromStorage();
            loadPlatforms();
        });
    </script>
</body>
</html>
